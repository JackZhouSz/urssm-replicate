device_select: 'auto'
model:
    name: 'URSSM'
    feature_extractor:
        name: 'DiffusionNet'
        args:
            in_channels: 128
            out_channels: 256
            cache_dir: '../data/FAUST_r/diffusion'
            input_type: 'wks'
    fm_solver:
        name: 'RegularizedFMNet'
        args: {}
    permutation:
        name: 'Similarity'
        args:
            tau: 0.07
train:
    script: 'TrainScript'
    dataset:
        train:
            name: 'PairFaustDataset'
            args:
                phase: 'train'
                data_root: 'data/FAUST_r/'
                return_evecs: 'true'
                return_faces: 'true'
                num_evecs: 200
                return_corr: 'false'
                return_dist: 'false'
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 1
                    shuffle: True
        test:
            name: 'PairFaustDataset'
            args:
                phase: 'test'
                data_root: 'data/FAUST_r/'
                return_evecs: 'true'
                return_faces: 'true'
                num_evecs: 200
                return_corr: 'false'
                return_dist: 'false'
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 1
                    shuffle: True
    loss:
        name: 'CompositeLoss'
        losses:
            - name: 'SURFMNetLoss_wrap'
              weight: 1.0
              args:
                w_bij: 1.0
                w_orth: 1.0
                w_lap: 0.0
            - name: 'SpatialSpectralAlignmentLoss_wrap'
              weight: 1.0
              args: {}
    metric:
        mean_diff_ratio:
            name: 'MeanDiffRatio'
            args: {}
        std_diff_ratio:
            name: 'StdDiffRatio'
            args: {}
        MAE:
            name: 'L1Loss'
            args: {}
        MSE:
            name: 'MSELoss'
            args: {}
    optimizer: 
        name: 'SGD'
        epochs: 100
        args:
            lr: 0.001
benchmark:
    script: 'TestScript'
    dataset:
        aug:
            name: 'Footprint2Pressure_SensorStack_Blend'
            args:
                footprint_wrap_folder: 'data/processed/footprint-wrap/'
                pedar_dynamic_path: 'data/processed/pedar_dynamic.pkl'
                l_mask_path: 'data/processed/left_foot_mask.png'
                sense_range: 600
                stack_range: 50
                img_size: 5
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 128
                    shuffle: True
        wo_aug:
            name: 'Footprint2Pressure_SensorStack'
            args:
                footprint_wrap_folder: 'data/processed/footprint-wrap/'
                pedar_dynamic_path: 'data/processed/pedar_dynamic.pkl'
                l_mask_path: 'data/processed/left_foot_mask.png'
                sense_range: 600
                stack_range: 50
                img_size: 5
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 128
                    shuffle: True
    metric:
        MAE:
            name: 'L1Loss'
            args: {}
        MSE:
            name: 'MSELoss'
            args: {}
sampling:
    script: 'SamplingScript'
    dataset:
        aug:
            name: 'Footprint2Pressure_SensorStack_Blend'
            args:
                footprint_wrap_folder: 'data/processed/footprint-wrap/'
                pedar_dynamic_path: 'data/processed/pedar_dynamic.pkl'
                l_mask_path: 'data/processed/left_foot_mask.png'
                sense_range: 600
                stack_range: 50
                img_size: 5
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 10
                    shuffle: False
            batch_select: [0, ]
        wo_aug:
            name: 'Footprint2Pressure_SensorStack'
            args:
                footprint_wrap_folder: 'data/processed/footprint-wrap/'
                pedar_dynamic_path: 'data/processed/pedar_dynamic.pkl'
                l_mask_path: 'data/processed/left_foot_mask.png'
                sense_range: 600
                stack_range: 50
                img_size: 5
            dataloader:
                name: 'DataLoader'
                args:
                    batch_size: 10
                    shuffle: False
            batch_select: [0, ]
    metric:
        MAE:
            name: 'PedarHeatmap'
            args:
                mask_path: 'data/processed/left_foot_mask.png'
                sense_range: 600
                export_folder: 'sample/'